---
layout: post
title: 怎么理解操作系统
---

# 怎样理解操作系统

## 引子

现代计算机软件系统非常依赖操作系统，程序员每天都在和操作系统打交道，你能想象没有系统调用的日子吗？

操作系统于日常中无所不在，而又披着一层神秘的面纱，以至于在程序员心中占据了宗教般的地位。我们依赖他而又不敢靠近他，致使经常碰到一些难以琢磨、似是而非的问题。比如以下几个：

* read系统调用失败时，为什么有时会设置EAGAIN错误码，有时又设置EINTR错误码？他们意味着什么？
* close系统调用也是会失败的，应用程序要怎么处理失败情况呢？
* 应用程序的信号处理函数是怎么被执行的？为什么最好只在其中执行设置flag之类的简单指令？

本文并不打算研究某个关于操作系统的具体问题，也不探讨具体的操作系统，而是提出理解操作系统的指导思想和方法论。

## 柏拉图主义

柏拉图是两千多年前的古希腊哲学家，他始终认为我们现实的世界是虚假的，真实的世界是理念的世界。现实世界只是我们通过理念创造出来的幻想。我举两个例子来说明计算机世界的虚幻性。

#### 看电影

打开电脑或者iPad看电影是某些人的一大爱好。电影视频以某种格式存在磁盘中，它的物理形式是一个一个的具有磁性的微小物体，但是人们确从中看到了一幕幕催人泪下的韩剧。从某种程度上说，我们看的不是电影，而是比特之间的关系。

#### 三体人的计算机

刘慈欣的《三体》是一本很流行的科幻小说，里面有个情景非常有意思。三体人造计算机，没有用硅也没有用真空管，而是用三体人自己。他们征集了很多三体人，不知道有没有Intel处理器中的晶体管数量那么多，组成一个巨大的人肉CPU。人肉CPU和晶体管CPU到底有多大差别呢，至少在逻辑上是没有差别的。

在理念世界中，没有物理，只有逻辑。我们要对逻辑有信心，操作系统是可以完全从逻辑上把握的。并且我们除了从逻辑出发，似乎别无他法，CPU集成了数十亿的晶体管，每秒执行成百上千万条指令，物理上已经超出了人类的理解范围了。

相信逻辑，我想这是柏拉图主义给我们最强有力的武器。

## 解构主义

解构主义是20世纪60年代兴起的哲学思潮，它把已经形成的概念打散，对所有的权威、习俗和原则提出挑战。操作系统中的概念不可谓不多，什么进程、虚拟存储、中断、信号等，使人抓耳挠腮。但是这一切都是在CPU指令上构建出来的，我们如果把所有的概念都打散成CPU指令，那么这些概念怪兽就瞬间变成了可怜的小虫子。解构的思想在理解进程切换和中断处理中有很好的体现。

## 总结

相信逻辑和打散概念是理解操作系统的强有力的思想武器。
